
		Neptune-X 用 Ethernet ドライバ改造版

		     ether_ne.sys ver0.03 +M01 +1 +L12


				original programmed by Shi-MAD
					    patched by Mitsuky
					    patched by nagai(LAC)
					    patched by Shimazaki Ryo



● このプログラムは

  Shi-MAD さんの作られた Ethernet 用 ISA バスブリッジ "Neptune-X" 用デバ
イスドライバ ether_ne.sys の改造版です。速度が７割程度向上しています（送
信時）。

　基底バージョンを ether_ne.sys ver 0.03 相当とした事で、Ko-window でも
利用可能となりました。

  LAN+USB+Memory統合拡張ボード Nereid（ネレイド）でもお使い頂けます。

  Nereid は、X68同人サークル X-PowerStation制作の同人ハードウェアです。

  この改造版についてオリジナルの原作者、作者に質問等する事はご遠慮ください。

  この改造版についてのお問い合わせは、

    http://x68k.net
    http://xps.jp
    http://x68ch.net

  以上、各サイトの X680x0に関する掲示板やメール ( nagai@x68k.net )にて
お願いします。



● 使い方

  高速な以外はオリジナルとコンパチですので使い方も同じです。デバイスドラ
イバとして CONFIG.SYS で組み込んで下さい。

　例）
	DEVICE = \SYS\etherL**.sys

  ver0.03相当を基底バージョンにしました。-t/-n オプションが使用可能です。

　以下のオプションが指定可能です。
  -tx [xは数字]  : 使用するtrapを指定します。xは０から６が指定可能です。
                   ただし、指定したtrapが使用中である場合は、trap #0から
                   空いている所を自動探索し、見つかった空きtrapを利用し
                   ます。
  -n             : APIにtrapを使用しません。

　なお、オプションを指定しない場合は、trap #0から空きを調べ、空いている
trapを利用します。

　例えば
　	DEVICE = A:\sys\ether_ne.sys -t1
　のようにconfig.sysに書けば、APIとしてtrap #1を使用しますが、もし
trap #1がすでに使用中であれば、trap #0から空きを調べ、空いているtrapを
使用します。
　それでも空きがない場合は、APIにtrapを使用しません。

　ちなみに、Ko-windowをご利用に方は、trap #0が使えませんので、必ずAPIで
使用するtrapを変更するか、[-n]オプションを指定し、APIにtrapを使用しない
ようにしてください。



● 開発環境＆速度比較

  // Mitsukyさんのコメント

　X68030-25MHz(cache on) + Neputune-Evolution
	+ ether_ne.sys + ftp.x
　自作 AT 機 i486SX-66MHz
	+ TFTPD(Windows95 用 FTP Daemon)
にて速度比較を行いました。

	・オリジナル ether_ne.sys
		受信 27KB/sec	送信 80KB/sec

	・改造版 ether_ne.sys
		受信 30KB/sec	送信 137KB/sec

  上記の結果は ftp.x の mput コマンドにおける転送速度表示を元にしています。
この値にはある程度の誤差が含まれている事を予め御了承下さい（ネットワーク
に流れているパケットの量によっても数字は変動します）。

  // nagai(LAC)のコメント

　X68030+060turbo + Nereid(最終白基板)
	+ etherL12 + ftpf.x
　FreeBSD ftpd
での速度

	・etherL12.sys
	(ether_ne.sys +M01から特に速度向上に関わる変更無し)
		受信 260KB/sec
		送信 643KB/sec

　X68030+060turbo + Nereid(最終白基板)
	+ etherL03 + nfs.x
　PC AthlonXP 2800+ Windows2000 SFU3.5
での速度

	・etherL03.sys
	(ether_ne.sys +M01から特に速度向上に関わる変更無し)
		受信 170KB/sec
		送信 170KB/sec



● コメント

  昔から Neptune-X や Nereid のイーサネット利用時にたまに通信できなく
なって、見た目には固まるような症状があったのですが、xip.x の -n の
ナイス値の関係なのかな？という位であまり気にしていませんでした。

  しかし最近になって、より積極的に X680x0のネットワークを利用するユーザが
増え、x68ちゃんねるという掲示板でその話題が取り上げられ、改めて確認すると
少々気になる頻度で「固まる」症状が現れたのでプログラムを修正してみようと
思いました。

　+L12 からは、安定バージョンリリースとして定義。立花えり子さんにご協力
頂いて、ver 0.03 相当の機能と不具合対応、これまでのパッチを統合などを
して頂きました。

　開発にご参加頂く場合には、基本となる本流のソースコード編集の都合が
ありますので、『+L**からの差分』などの形で変更点・更新点をご連絡頂け
ますと助かります。

　本流のソースコード更新が頻繁に行われていない場合には、更新する作業者の
判断でソースコード更新、更新版リリース等を行って頂いて結構です。

　但し、ソースファイルはバイナリを再構築できる形で必ず添付して提供する
ようにして下さい。

　ご連絡はリリース担当 永井(nagai@x68k.net)までお願いします。



● 配布規定

　オリジナルの ether_ne.sys のドキュメントより。

＞　サンプルリリースですが、転載は御自由になさってもらって結構です。
＞　プログラムの著作権は放棄しませんが、改造とかは御自由に。

との事ですので配布させていただきます。この改造版の配布規定もオリジナルの
それに従うことにします。転載に当たって私への連絡は不要です。

との事だと Mitsukyさんが仰っているので僕もそれに従います。



● 謝辞

  X680x0 に ISA バスブリッジを登載してネットワークカードを付けるというコ
ロンブスの卵的なハードウェアを開発された、そしてオリジナルの ether_ne.sys
を開発された Shi-MAD さんに感謝と賛辞を捧げます。ありがとうございました。

  ether_ne.sys +M01 を提供してくださった Mitsukyさんに感謝します。

　etherL12.sys では、ether_ne.sys ver 0.03 相当のソース作成、不具合対応、
パッチ統合などの作業を立花えり子さんに行って頂きました。お蔭様で大変素晴
らしいソースコードになりました。どうもありがとう御座いました。

  x68ちゃんねるで今回の改造をするきっかけをくれた 0083さん、動作報告を
して下さった GACHAさん、想田さん、ありがとう御座いました。

  Nereidは、配布と開発に参加してくれた皆さんのお蔭で無事に配布できました。

  全ての X680x0ユーザにありがとう。



● 連絡先（リリースエンジニア）

　X-PowerStation : http://xps.jp/
　X68K.NET : http://x68k.net/

　ハンドル名は ラキッ！/LAC/ラッキョ/永井良晴(本名)だったりします。

						    X68K.NET 代表
						 X-PowerStation
						      XPS.JP 代表
		      インターネットメールアドレス nagai@x68k.net



（ＥＯＦ）
