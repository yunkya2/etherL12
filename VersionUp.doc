● 改変履歴


2005-11-26 +L12  by Shimazaki Ryo
・基底バージョンを ether_ne.sys version 0.03 にアップデート
  （API を使用しない場合に NMI をフックする不具合は修正済み）。
・ファンクションコール -2（送受信カウンタのアドレス取得）を追
  加。
・insw()、outsw() を作り直し、memcpy.h にインライン関数化。
・hmemcpy() を使わないようにした。
・パケット送信時の一時バッファ（tx_buff）を使わないようにした。
・送信データ書き込み後のウェイトを削除。

・API #8（SetMulticastAddr）、#9（GetStatistics）を使用すると、
  エラーで白帯が表示される不具合を修正。

・ne2000.c::DP8390_Reset() でI/O ポートに volatile が指定されて
  いない不備を修正。
・ne2000.h の semophore を semaphore に変更、volatile が指定さ
  れていない不備を修正。

・API #5（SetIntAddr）、#7（DelIntAddr）で登録／削除失敗した時
  は割り込みを許可／禁止しないようにした。
・main.c::AddList() で、type == -1 のときはエラーを返すように
  した。
・Print() を _iocs_b_print() へのマクロに変更。

・デバッグコードを debug.h に分離、マクロ化。
・タイトル表示がずれていたのを修正。
・ソースコードを整理、無駄なコード、未使用変数の削除。



2005/10/29 +L11
・このドキュメントの誤りを修正。
・ne2000.cのセマフォがセモフォなのはそのまま。



2005/10/26 +L11
・srを破壊していた不具合というかシャアを撃墜。
　普通にsr保存して復帰するようにした。(ne2000.c)
・DI()割り込み禁止 EI()割り込み許可 を追加 asmbub.s



2005/10/26 +L10
・送信のセマフォを追加。
・X68030+060turbo環境で xip -n 32 の指定で動作することを確認。
・Mitsukyさんのご指摘で下記の修正を施す。

 ・EdXmit() sc->xmit_busy = 1; 位置修正。
 ・ne.s tst.l _num_op_prt(pc) (pc)削除。
 ・main.h 80 sprintfの行削除。



2005/10/25 +L09
・EdIntr の ISR をリセットして読むところにウェイトをすべて削除。
・送信中は割り込み禁止。



2005/10/24 +L07
・このソースだとXmitでtxb_inuseの数をチェックする必要があるのに
忘れていてエンバグ。修正。
・EdIntr の ISR をリセットして読むところにウェイトを挿入。
　昔ながらのジョイスティックポート空読み。



2005/10/24 +L06
・結局 EdInit() は全部外すことにした。EdIntr内でループした際に
EdInit()を実行してしまうとまずいと思う。



2005/10/23 +L05
・バッファを一つ残してのバースト転送が上手く作れなかったので、急
遽不具合対応部分のみを含めた +L05 をリリースすることにした。



2005/10/22 +L04
・EdInit()内の sc->next_packet を巻き戻している部分がまずい気が
してきたのと、そもそもEdInit()自体不要に思えてきたので処理内容か
ら除外する事にした。
・実験的に gcc 最適化オプションを付加したバイナリを同梱した。
　（etherO04.sys）



（ＥＯＦ）
